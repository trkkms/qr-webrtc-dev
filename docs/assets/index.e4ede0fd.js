var vt=Object.defineProperty;var Oe=Object.getOwnPropertySymbols;var wt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;var We=(e,t,n)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ce=(e,t)=>{for(var n in t||(t={}))wt.call(t,n)&&We(e,n,t[n]);if(Oe)for(var n of Oe(t))yt.call(t,n)&&We(e,n,t[n]);return e};import{a as De,b as xt,c as me,u as x,r as u,n as He,d as P,t as ne,l as de,s as D,e as Ve,j as r,f as c,g as oe,F as C,R as fe,h as Tt,i as kt,k as Ae,G as St,m as U,P as Ct,v as Dt,o as At,p as _t}from"./vendor.231bdc28.js";const Ft=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};Ft();const _e=De(!1),be=xt("as","host",{replaceState:!0,serialize:e=>e,deserialize:e=>e==="host"?"host":"guest"}),Ge=me([]),Bt=()=>P(Ge),S=()=>{const e=x(Ge),t=n=>u.exports.useCallback(o=>{console[n==="info"||n==="success"?"log":n](o);const i=new Date,a=He();return e(l=>{l.unshift({message:o,timestamp:i,level:n,id:a})})},[]);return{info:t("info"),warn:t("warn"),error:t("error"),success:t("success")}},Fe=me({mic:{volume:1,muted:!1},speaker:{volume:1,muted:!1,unlockLimit:!1}});De(void 0);const E=()=>{const e=P(be),t={main:"#282828",dark:"#000000",light:"#404040"},n={main:"#81d4fa",light:"#b6ffff",dark:"#4ba3c7",text:"#202020"},o={main:"#ffee58",light:"#ffff8b",dark:"#c9bc1f",text:"#202020"};return{color:{background:t,primary:e==="host"?n:o,secondary:e==="host"?o:n,alert:{main:"#ff8a65",light:"#ffbb93",dark:"#c75b39",text:"#202020"},text:"#E8E8E8"}}},R=e=>{let t=new Audio;t.muted=!0,t.srcObject=e,t.addEventListener("canplaythrough",()=>{t=null})},Be=(e,t,n,o,s,i,a)=>{"ontrack"in e?(s.info("set ontrack event"),e.ontrack=l=>{s.info("ontrack event detected");for(const f of l.streams)s.info("loop on stream"),R(f),t.createMediaStreamSource(f).connect(n),i(o.stream).then(()=>{s.info("update stream")})}):(s.info("set onaddstream event"),e.onaddstream=l=>{s.info("onaddstream event detected"),R(l.stream),t.createMediaStreamSource(l.stream).connect(n),i(o.stream).then(()=>{s.info("update stream")})})},Ue=(e,t)=>{const n=e.createGain(),o=e.createMediaStreamDestination();return e.createMediaStreamSource(t).connect(n),n.connect(o),[a=>{n.gain.setValueAtTime(a,e.currentTime)},o.stream]},Et=async()=>await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:{ideal:640},height:{ideal:480}}}),z=()=>{let e=()=>{};const t=new Promise(n=>{e=n});return[n=>e(n),()=>t]},Rt=ne({type:de("acceptGuest"),guestId:D,others:Ve(ne({id:D,name:D}))}),ze=ne({type:de("offer"),from:D,name:D,to:D,sdp:D}),jt=ne({type:de("acceptHost"),guestId:D,name:D,offers:Ve(ze)}),Qe=ne({type:de("answer"),from:D,to:D,sdp:D}),$t=(e,t,n,o,s)=>{const i=new Map,[a,l]=z();return t().then(async f=>{f.onmessage=async m=>{const d=JSON.parse(m.data);if(Rt.is(d)){o.info("accepted by host");const p=d.guestId;a(d.guestId);const y=[];for(const N of d.others){const w=new RTCPeerConnection({iceServers:[]});n(w);const A={peer:w,id:N.id,name:N.name};i.set(N.id,A),await w.setLocalDescription(await w.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}));const O=await new Promise(Se=>{w.onicecandidate=ce=>{!ce.candidate&&w.localDescription&&Se(w.localDescription.sdp)}});y.push({type:"offer",from:p,to:N.id,name:e,sdp:O}),w.onconnectionstatechange=()=>{o.info(`connection state change to ${A.id}: ${w.connectionState}`),s()}}const B={type:"acceptHost",guestId:p,offers:y,name:e};f.send(JSON.stringify(B))}if(ze.is(d)){o.info(`received offer from: ${d.from}`);const p=await l(),y=new RTCPeerConnection({iceServers:[]});n(y),i.set(d.from,{id:d.from,peer:y,name:d.name}),await y.setRemoteDescription({type:"offer",sdp:d.sdp}),await y.setLocalDescription(await y.createAnswer()),y.onconnectionstatechange=()=>{o.info(`connection state change to ${d.from}: ${y.connectionState}`),s()};const B=await new Promise(w=>{y.onicecandidate=A=>{!A.candidate&&y.localDescription&&w(y.localDescription.sdp)}}),N={type:"answer",from:p,to:d.from,sdp:B};f.send(JSON.stringify(N))}if(Qe.is(d)){o.info(`received answer from ${d.from}`);const p=i.get(d.from);if(p==null)return;p.peer.onconnectionstatechange=()=>{o.info(`connection state change to ${d.from}: ${p.peer.connectionState}`),s()},await p.peer.setRemoteDescription({type:"answer",sdp:d.sdp})}}}),{peers:i}},Pt=(e,t)=>(n,o)=>{if(jt.is(o)){t.info(`${o.guestId.slice(0,5)} / accepted by guest`);const s=e.get(o.guestId);if(s==null)return;s.setName(o.name);for(const i of o.offers){t.info(`${i.to.slice(0,5)} / sending offer`);const a=e.get(i.to);a!=null&&a.sendMessage(i)}}if(Qe.is(o)){const s=e.get(o.to);if(t.info(`${o.to.slice(0,5)} / sending answer from ${o.from.slice(0,5)}`),s==null)return;s.sendMessage(o)}},qt=async(e,t,n)=>{const o=new Map,s=new AudioContext,i=s.createGain(),a=s.createMediaStreamDestination();i.connect(a);const l=s.createMediaStreamDestination(),f=await navigator.mediaDevices.getUserMedia({video:!1,audio:{latency:.01,echoCancellation:!0}}),[m,d]=z();R(f);const p=f.clone();R(p),s.createMediaStreamSource(p).connect(l);const[B,N]=Ue(s,f),w=async b=>{t.info(`speaker volume set to ${b}`),!(b<=1)&&(i.gain.value=b,await e(a.stream))};await e(a.stream);const A=Pt(o,t);return{createPeer:async()=>{const b=He(),[g,_]=z(),v=new RTCPeerConnection({iceServers:[]}),q=N.clone();R(q);for(const F of q.getTracks())v.addTrack(F,q);Be(v,s,i,a,t,e),v.onconnectionstatechange=()=>{t.info(`${b.slice(0,5)} / connection state change: ${v.connectionState}`),n()};const k=v.createDataChannel("host-to-guest"),[ue,Ie]=z();k.onopen=()=>{t.info(`${b.slice(0,5)} / data channel established`),ue(k)},k.onmessage=F=>{A(b,JSON.parse(F.data))},await v.setLocalDescription(await v.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}));const Le=await new Promise(F=>{v.onicecandidate=$=>{!$.candidate&&v.localDescription&&F(v.localDescription.sdp)}}),W={id:b,sdp:Le,connect:async F=>{const $=new Promise(Nt=>{v.onconnectionstatechange=()=>{t.info(`${b.slice(0,5)} / connection state change: ${v.connectionState}`),n(),v.connectionState==="connected"&&Nt()}});return await v.setRemoteDescription({type:"answer",sdp:F}),$},close:()=>{v.close(),o.delete(b),n()},getConnectionState:()=>v.connectionState,sendMessage:async F=>{(await Ie()).send(JSON.stringify(F))},data:k,setName:g,getName:_};return o.set(b,W),W},getPeer:b=>o.get(b),getPeers:()=>o,changeVolume:B,startRecording:()=>{const b=l.stream.clone();R(b);const g=s.createMediaStreamSource(b);g.connect(l);const _=l.stream;m(g);const[v,q]=MediaRecorder.isTypeSupported("audio/mp4")?["mp4","audio/mp4"]:["webm","audio/webm"],k=new MediaRecorder(_,{mimeType:q,audioBitsPerSecond:64e3}),ue=[];return k.ondataavailable=W=>{ue.push(W.data)},k.start(1e3),{stopRecording:()=>{k.pause()},save:()=>{const W=new Blob(ue,{type:q}),F=URL.createObjectURL(W),$=document.createElement("a");$.download=`recorded.${v}`,$.href=F,$.target="_blank",$.click()},clear:async()=>{(k.state==="paused"||k.state==="recording")&&(k.stop(),(await d()).disconnect(l))},getRecordState:()=>k.state,pause:()=>{k.pause()},resume:()=>{k.resume()}}},changeSpeakerVolume:w}},H=me([]),Je=De({}),Ke=()=>{const e=x(Je);return u.exports.useCallback(()=>{e(Symbol())},[])},Ye=()=>{P(Je)};var Xe="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-00-init.tsx";const Mt=({setService:e,setCurrentPeer:t,playAudio:n})=>{const{color:o}=E(),s=x(_e),i=x(H),a=S(),l=Ke();return r("div",{css:c({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}),children:r("button",{type:"button",css:c({padding:"0.5rem 1rem",outline:"none",border:"none",background:o.primary.main,color:o.primary.text,fontSize:"1.5rem",width:"14rem"}),onClick:async()=>{const f=await qt(n,a,l),m=await f.createPeer();e(f),s(!0),t(m),i(d=>{d.push({stage:1,sdp:m.sdp})})},children:"\u63A5\u7D9A\u958B\u59CB"},void 0,!1,{fileName:Xe,lineNumber:27,columnNumber:7},globalThis)},void 0,!1,{fileName:Xe,lineNumber:26,columnNumber:5},globalThis)};var Ze="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\audio-control.tsx";const et=({audioRef:e})=>{const t=P(Fe);return u.exports.useEffect(()=>{if(e.current){const n=t.speaker.volume>1?1:t.speaker.volume;e.current.volume=t.speaker.muted?0:n}},[t.speaker.volume,t.speaker.muted]),r("div",{children:r("audio",{autoPlay:!0,ref:e},void 0,!1,{fileName:Ze,lineNumber:22,columnNumber:7},globalThis)},void 0,!1,{fileName:Ze,lineNumber:21,columnNumber:5},globalThis)};let h,tt=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});tt.decode();let ge=null;function Q(){return(ge===null||ge.buffer!==h.memory.buffer)&&(ge=new Uint8Array(h.memory.buffer)),ge}function Ee(e,t){return tt.decode(Q().subarray(e,e+t))}let J=0,he=new TextEncoder("utf-8");const It=typeof he.encodeInto=="function"?function(e,t){return he.encodeInto(e,t)}:function(e,t){const n=he.encode(e);return t.set(n),{read:e.length,written:n.length}};function Lt(e,t,n){if(n===void 0){const l=he.encode(e),f=t(l.length);return Q().subarray(f,f+l.length).set(l),J=l.length,f}let o=e.length,s=t(o);const i=Q();let a=0;for(;a<o;a++){const l=e.charCodeAt(a);if(l>127)break;i[s+a]=l}if(a!==o){a!==0&&(e=e.slice(a)),s=n(s,o,o=a+e.length*3);const l=Q().subarray(s+a,s+o);a+=It(e,l).written}return J=a,s}let pe=null;function K(){return(pe===null||pe.buffer!==h.memory.buffer)&&(pe=new Int32Array(h.memory.buffer)),pe}function Ot(e,t){return Q().subarray(e/1,e/1+t)}function Wt(e){try{const i=h.__wbindgen_add_to_stack_pointer(-16);var t=Lt(e,h.__wbindgen_malloc,h.__wbindgen_realloc),n=J;h.compress(i,t,n);var o=K()[i/4+0],s=K()[i/4+1];let a;return o!==0&&(a=Ot(o,s).slice(),h.__wbindgen_free(o,s*1)),a}finally{h.__wbindgen_add_to_stack_pointer(16)}}function nt(e,t){const n=t(e.length*1);return Q().set(e,n/1),J=e.length,n}function Ht(e,t){try{const a=h.__wbindgen_add_to_stack_pointer(-16);var n=nt(e,h.__wbindgen_malloc),o=J;h.into_svg(a,n,o,t);var s=K()[a/4+0],i=K()[a/4+1];let l;return s!==0&&(l=Ee(s,i).slice(),h.__wbindgen_free(s,i*1)),l}finally{h.__wbindgen_add_to_stack_pointer(16)}}function ot(e){try{const i=h.__wbindgen_add_to_stack_pointer(-16);var t=nt(e,h.__wbindgen_malloc),n=J;h.inflate(i,t,n);var o=K()[i/4+0],s=K()[i/4+1];let a;return o!==0&&(a=Ee(o,s).slice(),h.__wbindgen_free(o,s*1)),a}finally{h.__wbindgen_add_to_stack_pointer(16)}}async function Vt(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(o){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}async function st(e){typeof e=="undefined"&&(e=new URL("/qr-webrtc-dev/assets/wasm_bg.5810598b.wasm",self.location));const t={};t.wbg={},t.wbg.__wbg_alert_f5393de24ed74e50=function(s,i){alert(Ee(s,i))},(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await Vt(await e,t);return h=n.exports,st.__wbindgen_wasm_module=o,h}var Gt="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\qr-generator.tsx";const rt=({src:e,cacheKey:t})=>{const n=u.exports.useRef({}),o=S(),s=u.exports.useMemo(()=>{const i=n.current[t];if(i)return i;const a=Ht(e,300);return a===void 0?(o.error("QR Code creation failed for some reason."),""):(n.current[t]=a,a)},[e,t]);return u.exports.useEffect(()=>{},[e,t]),r("div",{dangerouslySetInnerHTML:{__html:s}},void 0,!1,{fileName:Gt,lineNumber:34,columnNumber:10},globalThis)};var se="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\back-next-button.tsx";const Y=({backTitle:e,nextTitle:t,onBack:n,onNext:o})=>{const{color:s}=E();return r("ul",{css:c({display:"grid",gridTemplateColumns:"50% 50%",width:"100%",padding:"2rem",gap:"1rem",maxWidth:"400px"}),children:[e!=null&&r("li",{children:r("button",{type:"button",css:c({width:"100%",height:"2rem",border:"none",outline:"none",background:s.primary.main}),onClick:n,children:e},void 0,!1,{fileName:se,lineNumber:30,columnNumber:11},globalThis)},void 0,!1,{fileName:se,lineNumber:29,columnNumber:9},globalThis),t&&r("li",{css:c({display:"flex",justifyContent:"center",alignItems:"center"}),children:r("button",{type:"button",css:c({width:"100%",height:"2rem",border:"none",outline:"none",background:s.primary.main}),onClick:o,children:t},void 0,!1,{fileName:se,lineNumber:47,columnNumber:11},globalThis)},void 0,!1,{fileName:se,lineNumber:46,columnNumber:9},globalThis)]},void 0,!0,{fileName:se,lineNumber:18,columnNumber:5},globalThis)};var it="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\chapter.tsx";const j=({title:e,children:t})=>r("section",{css:c({display:"flex",flexWrap:"wrap",justifyContent:"center",width:"100%",padding:"1rem"}),children:[r("h2",{css:c({width:"100%",marginBottom:"1rem",fontSize:"larger"}),children:e},void 0,!1,{fileName:it,lineNumber:15,columnNumber:7},globalThis),t]},void 0,!0,{fileName:it,lineNumber:14,columnNumber:5},globalThis),at=(e,t,n,o,s)=>{const i=u.exports.useMemo(()=>{const a=Wt(e);if(a==null){n.error("Failed to compress sdp.");return}return new Uint8Array(a)},o);return u.exports.useMemo(()=>i==null?void 0:t===1?i.subarray(0,i.length/2):i.subarray(i.length/2),s)};var lt="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\step-bar.tsx";const X=({count:e,titles:t})=>{const n=E();return r(C,{children:r("ol",{css:c({listStyleType:"none",position:"relative",margin:"20px 0 0",padding:0,display:"flex",flexWrap:"wrap",justifyContent:"space-between","& > li":{position:"relative",textAlign:"center",width:"24%",color:"#B0B0B0",fontWeight:"bold",counterIncrement:"steps",fontSize:"small"},"& > li:before":{display:"block",width:"26px",height:"26px",margin:"7px auto 20px auto",lineHeight:"26px",fontSize:"12px",textAlign:"center",borderRadius:"50%",backgroundColor:"#808080",content:"counter(steps)"},"& > li:after":{position:"absolute",zIndex:-1,top:"15px",left:"-50%",width:"100%",height:"2px",content:'""',backgroundColor:"#808080"},"& > li:first-of-type:after":{content:"none"},"& > li.active:before":{backgroundColor:n.color.primary.main,color:n.color.primary.text},"& > li.complete:before":{backgroundColor:n.color.primary.main,color:n.color.primary.text},"& > li.active:after":{backgroundColor:n.color.primary.main},"& > li.complete:after":{backgroundColor:n.color.primary.main}}),children:t.map((o,s)=>{const i=s<e;return r("li",{className:oe({active:s===e,complete:i}),children:o},o,!1,{fileName:lt,lineNumber:81,columnNumber:13},globalThis)})},void 0,!1,{fileName:lt,lineNumber:18,columnNumber:7},globalThis)},void 0,!1)};var M="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-01-offer.tsx";const Ut=fe.memo(function({stage:t}){const n=x(H),[o,s]=u.exports.useState(1),i=S(),a=u.exports.useCallback(()=>{o===2?s(1):n(()=>[{stage:5}])},[o]),l=u.exports.useCallback(async()=>{o===1?s(2):n(d=>{d.push({stage:2})})},[o]),f=o===1?"1.\u30AA\u30D5\u30A1\u30FC(\u524D\u534A)":"2.\u30AA\u30D5\u30A1\u30FC(\u5F8C\u534A)",m=at(t.sdp,o,i,[t],[t,o]);return r(C,{children:[r(X,{count:o-1,titles:Re},void 0,!1,{fileName:M,lineNumber:46,columnNumber:7},this),r(j,{title:f,children:[m&&r("div",{css:c({display:"flex",justifyContent:"center",width:"100%",marginBottom:"1rem"}),children:r(rt,{src:m,cacheKey:`host-offer-${o}`},void 0,!1,{fileName:M,lineNumber:50,columnNumber:13},this)},void 0,!1,{fileName:M,lineNumber:49,columnNumber:11},this),r("p",{css:c({width:"100%",fontFamily:"monospace",paddingLeft:"1rem"}),children:r("span",{children:"\u63A5\u7D9A\u3059\u308B\u30B2\u30B9\u30C8\u306B\u63D0\u793A\u3057\u3066\u304F\u3060\u3055\u3044\u3002"},void 0,!1,{fileName:M,lineNumber:54,columnNumber:11},this)},void 0,!1,{fileName:M,lineNumber:53,columnNumber:9},this),o===2&&r("p",{css:c({width:"100%",fontFamily:"monospace",paddingLeft:"1rem"}),children:"\u300C\u6B21\u3078\u300D\u3092\u62BC\u3059\u3068\u30AB\u30E1\u30E9\u304C\u8D77\u52D5\u3057\u307E\u3059\u3002"},void 0,!1,{fileName:M,lineNumber:58,columnNumber:11},this),r(Y,{backTitle:o===2?"\u623B\u308B":"\u30B2\u30B9\u30C8\u4E00\u89A7",nextTitle:"\u6B21\u3078",onBack:a,onNext:l},void 0,!1,{fileName:M,lineNumber:63,columnNumber:9},this)]},void 0,!0,{fileName:M,lineNumber:47,columnNumber:7},this)]},void 0,!0)});var Z="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\qr-scanner.tsx";const Ne=({onResult:e})=>{const t=u.exports.useRef(null),n=u.exports.useRef(null),o=S(),[s,i]=u.exports.useState(void 0),{color:a}=E();return u.exports.useEffect(()=>{const f=(async()=>{if(!s)return;const m=n.current;if(!m)return;const d=t.current;if(d==null){o.error("Failed to get canvas element.");return}const p=d.getContext("2d");if(p==null){o.error("Failed to get canvas context");return}return requestAnimationFrame(function B(){const N=t.current;if(N==null)return;if(m.readyState!==m.HAVE_ENOUGH_DATA){setTimeout(()=>{B()},200);return}N.width=m.videoWidth,N.height=m.videoHeight,p.drawImage(m,0,0,N.width,N.height);const w=p.getImageData(0,0,N.width,N.height),A=Tt(w.data,w.width,w.height,{inversionAttempts:"dontInvert"});if(!A){requestAnimationFrame(B);return}e(A),s.getTracks().forEach(O=>{O.readyState==="live"&&O.stop()})}),s})().catch(m=>{o.error(`Cannot get video stream: ${String(m)}`)});return()=>{f.then(m=>{m&&m.getTracks().forEach(d=>{d.readyState==="live"&&d.stop()})})}},[s]),r("div",{css:c({width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap"}),children:[r("video",{css:c({display:"block",width:"80%"}),ref:n,autoPlay:!0,muted:!0,playsInline:!0},void 0,!1,{fileName:Z,lineNumber:93,columnNumber:7},globalThis),r("div",{css:c({width:"100%"}),children:r("canvas",{css:c({display:"none",width:"100%"}),ref:t},void 0,!1,{fileName:Z,lineNumber:95,columnNumber:9},globalThis)},void 0,!1,{fileName:Z,lineNumber:94,columnNumber:7},globalThis),r("div",{css:c({width:"100%",display:"flex",justifyContent:"center"}),children:!s&&r("button",{css:c({width:"50%",height:"2rem",border:"none",outline:"none",background:a.primary.main}),onClick:()=>{Et().then(l=>{o.info("stream acquired."),n.current&&(o.info("attached to video."),n.current.srcObject=l,n.current.play().then(()=>{o.info("video started")})),i(l)})},children:"\u30AB\u30E1\u30E9\u3092\u8D77\u52D5\u3059\u308B"},void 0,!1,{fileName:Z,lineNumber:99,columnNumber:11},globalThis)},void 0,!1,{fileName:Z,lineNumber:97,columnNumber:7},globalThis)]},void 0,!0,{fileName:Z,lineNumber:90,columnNumber:5},globalThis)};var ve="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-02-answer1.tsx";const zt=()=>{const[e,t]=u.exports.useState(void 0),n=x(H),o=S(),s=u.exports.useCallback(l=>{o.info("answer1 received:"),t(l.binaryData)},[]),i=u.exports.useCallback(()=>{n(l=>{l.pop()})},[]),a=u.exports.useCallback(async()=>{e!=null&&n(l=>{l.push({stage:3,halfAnswer:e})})},[e]);return r(C,{children:[r(X,{count:2,titles:Re},void 0,!1,{fileName:ve,lineNumber:44,columnNumber:7},globalThis),r(j,{title:"3.\u30A2\u30F3\u30B5\u30FC\u53D7\u4FE1(\u524D\u534A)",children:[e==null&&r(Ne,{onResult:s},void 0,!1,{fileName:ve,lineNumber:46,columnNumber:29},globalThis),r(Y,{backTitle:"\u623B\u308B",onBack:i,nextTitle:e!=null?"\u6B21\u3078":void 0,onNext:a},void 0,!1,{fileName:ve,lineNumber:47,columnNumber:9},globalThis)]},void 0,!0,{fileName:ve,lineNumber:45,columnNumber:7},globalThis)]},void 0,!0)};var we="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-03-answer2.tsx";const Qt=({stage:e})=>{const[t,n]=u.exports.useState(void 0),o=x(H),s=S(),i=u.exports.useCallback(l=>{s.info("answer2 received:");const f=ot(new Uint8Array([...e.halfAnswer,...l.binaryData]));f!=null?(n(f),o(m=>{m.push({stage:4,sdp:f})})):s.error("Decoding SDP Failed")},[]),a=u.exports.useCallback(()=>{o(l=>{n(void 0),l.pop()})},[]);return r(C,{children:[r(X,{count:2,titles:Re},void 0,!1,{fileName:we,lineNumber:44,columnNumber:7},globalThis),r(j,{title:"4.\u30A2\u30F3\u30B5\u30FC\u53D7\u4FE1(\u5F8C\u534A)",children:[t==null&&r(Ne,{onResult:i},void 0,!1,{fileName:we,lineNumber:46,columnNumber:25},globalThis),r(Y,{backTitle:"\u623B\u308B",onBack:a},void 0,!1,{fileName:we,lineNumber:47,columnNumber:9},globalThis)]},void 0,!0,{fileName:we,lineNumber:45,columnNumber:7},globalThis)]},void 0,!0)};var ct="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-04-try-connect.tsx";const Jt=({stage:e,peer:t,service:n})=>{const o=S(),s=x(H);return u.exports.useEffect(()=>{(async()=>{await t.connect(e.sdp);const a={type:"acceptGuest",guestId:t.id,others:await Promise.all(Array.from(n.getPeers().values()).filter(l=>l.id!==t.id).map(async l=>({id:l.id,name:await l.getName()})))};await t.sendMessage(a),s(()=>[{stage:5}])})().catch(a=>{o.error(`Failed to receive answer: ${String(a)}`)})},[]),r(j,{title:"5. \u63A5\u7D9A\u4E2D",children:r("p",{children:"\u63A5\u7D9A\u4E2D\u3067\u3059..."},void 0,!1,{fileName:ct,lineNumber:47,columnNumber:7},globalThis)},void 0,!1,{fileName:ct,lineNumber:46,columnNumber:5},globalThis)};var T="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-05-guest-list.tsx";const Kt=({textP:e})=>{const[t,n]=u.exports.useState(void 0);return u.exports.useEffect(()=>{e.then(o=>{n(o)})},[]),r(C,{children:t!=null?t:""},void 0,!1)},Yt=({service:e,setCurrentPeer:t})=>{const n=e.getPeers(),[o,s]=u.exports.useState(void 0),i=x(H);Ye();const{color:a}=E();return u.exports.useEffect(()=>{for(const l of n.values())l.getConnectionState()!=="connected"&&l.close()},[]),r(j,{title:"\u30B2\u30B9\u30C8\u4E00\u89A7",children:[r("div",{children:[n.size===0&&r("p",{css:c({marginBottom:"5rem"}),children:"\u307E\u3060\u63A5\u7D9A\u306F\u3042\u308A\u307E\u305B\u3093\u3002"},void 0,!1,{fileName:T,lineNumber:50,columnNumber:30},globalThis),r("div",{css:c({display:"flex",justifyContent:"center"}),children:r("button",{type:"button",css:c({border:"none",outline:"none",padding:"0.5rem 1rem",background:a.primary.main}),onClick:async()=>{const l=await e.createPeer();t(l),i(()=>[{stage:1,sdp:l.sdp}])},children:"\u65B0\u898F\u63A5\u7D9A"},void 0,!1,{fileName:T,lineNumber:52,columnNumber:11},globalThis)},void 0,!1,{fileName:T,lineNumber:51,columnNumber:9},globalThis),n.size>0&&r("ol",{css:c({display:"flex",flexWrap:"wrap",padding:"1rem",width:"100%"}),children:[...n.values()].map(l=>r("li",{css:c({display:"flex",justifyContent:"space-between",width:"100%"}),children:[r("span",{css:c({marginRight:"1rem"}),children:l.id.slice(0,6)},void 0,!1,{fileName:T,lineNumber:74,columnNumber:17},globalThis),r("span",{css:c({marginRight:"1rem"}),children:r(Kt,{textP:l.getName()},void 0,!1,{fileName:T,lineNumber:76,columnNumber:19},globalThis)},void 0,!1,{fileName:T,lineNumber:75,columnNumber:17},globalThis),r("span",{children:l.getConnectionState()},void 0,!1,{fileName:T,lineNumber:78,columnNumber:17},globalThis),r("button",{type:"button",css:c({border:"none",outline:"none",width:"2rem",background:a.secondary.dark}),onClick:()=>{l.close()},children:"\xD7"},void 0,!1,{fileName:T,lineNumber:79,columnNumber:17},globalThis)]},l.id,!0,{fileName:T,lineNumber:73,columnNumber:15},globalThis))},void 0,!1,{fileName:T,lineNumber:71,columnNumber:11},globalThis)]},void 0,!0,{fileName:T,lineNumber:49,columnNumber:7},globalThis),r("div",{css:c({display:"none",justifyContent:"center",width:"100%"}),children:[r("button",{type:"button",css:c({border:"none",outline:"none",padding:"0.5rem 1rem",background:a.primary.main}),onClick:()=>{if(o==null){const l=e.startRecording();s(l);return}o.getRecordState()==="paused"&&(o.resume(),s(Ce({},o))),o.getRecordState()==="recording"&&(o.pause(),s(Ce({},o)))},children:o?"\u9332\u97F3\u505C\u6B62":"\u9332\u97F3\u958B\u59CB"},void 0,!1,{fileName:T,lineNumber:94,columnNumber:9},globalThis),o&&r("button",{type:"button",css:c({border:"none",outline:"none",padding:"0.5rem 1rem",background:a.primary.main}),onClick:()=>{o.clear(),s(void 0)},children:"\u30AF\u30EA\u30A2"},void 0,!1,{fileName:T,lineNumber:121,columnNumber:11},globalThis),o&&o.getRecordState()==="paused"&&r("button",{type:"button",css:c({border:"none",outline:"none",padding:"0.5rem 1rem",background:a.primary.main}),onClick:()=>{o.save()},children:"\u4FDD\u5B58"},void 0,!1,{fileName:T,lineNumber:138,columnNumber:11},globalThis)]},void 0,!0,{fileName:T,lineNumber:93,columnNumber:7},globalThis)]},void 0,!0,{fileName:T,lineNumber:48,columnNumber:5},globalThis)};var re="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\host-stages.tsx";const Xt=({service:e,peer:t,setCurrentPeer:n})=>{const o=P(H),s=o[o.length-1];return s==null?null:s.stage===1?r(Ut,{stage:s},void 0,!1,{fileName:re,lineNumber:27,columnNumber:12},globalThis):s.stage===2?r(zt,{},void 0,!1,{fileName:re,lineNumber:30,columnNumber:12},globalThis):s.stage===3?r(Qt,{stage:s},void 0,!1,{fileName:re,lineNumber:33,columnNumber:12},globalThis):s.stage===4?r(Jt,{service:e,stage:s,peer:t},void 0,!1,{fileName:re,lineNumber:36,columnNumber:12},globalThis):s.stage===5?r(Yt,{service:e,setCurrentPeer:n},void 0,!1,{fileName:re,lineNumber:39,columnNumber:12},globalThis):r(C,{},void 0,!1)},Re=["\u9001\u4FE1(\u524D\u534A)","\u9001\u4FE1(\u5F8C\u534A)","\u53D7\u4FE1(\u524D\u534A)","\u53D7\u4FE1(\u5F8C\u534A)"],ut=({service:e})=>{const t=P(Fe);return u.exports.useEffect(()=>{e.changeVolume(t.mic.muted?0:t.mic.volume)},[t.mic.volume,t.mic.muted]),u.exports.useEffect(()=>{e.changeSpeakerVolume(t.mic.muted?0:t.mic.volume)},[t.speaker.volume,t.speaker.muted]),r(C,{},void 0,!1)};var ie="D:\\komesu\\web\\qr-webrtc\\src\\components\\pages\\host.tsx";const Zt=()=>{const[e,t]=u.exports.useState(),[n,o]=u.exports.useState(),s=S(),i=u.exports.useRef(null),a=u.exports.useCallback(async l=>{if(i.current==null){s.warn("ignore playAudio() since no audio element found.");return}i.current.srcObject=l,await i.current.play()},[]);return r("main",{css:c({width:"100%",height:"100%",maxWidth:1200}),children:[!e&&r(Mt,{setService:t,setCurrentPeer:o,playAudio:a},void 0,!1,{fileName:ie,lineNumber:32,columnNumber:20},globalThis),e&&n!=null&&r(Xt,{service:e,peer:n,setCurrentPeer:o},void 0,!1,{fileName:ie,lineNumber:34,columnNumber:9},globalThis),r(et,{audioRef:i},void 0,!1,{fileName:ie,lineNumber:36,columnNumber:7},globalThis),e&&r(ut,{service:e},void 0,!1,{fileName:ie,lineNumber:37,columnNumber:19},globalThis)]},void 0,!0,{fileName:ie,lineNumber:25,columnNumber:5},globalThis)},en=async(e,t,n,o)=>{const s=new AudioContext,i=s.createGain(),a=s.createMediaStreamDestination();i.connect(a);const l=await navigator.mediaDevices.getUserMedia({video:!1,audio:{latency:.01,echoCancellation:!0}});R(l);const[f,m]=Ue(s,l),d=async b=>{t.info(`speaker volume set to ${b}`),!(b<=1)&&(i.gain.value=b,await e(a.stream))};R(m),await e(a.stream);const[p,y]=z(),[B,N]=z(),w=async()=>{const b=new RTCPeerConnection({iceServers:[]}),g=m.clone();R(g);for(const _ of g.getTracks())b.addTrack(_,g);return Be(b,s,i,a,t,e),b.onconnectionstatechange=()=>{t.info(`host connection state change: ${b.connectionState}`)},b.ondatachannel=_=>{t.info("data channel established"),p(_.channel)},B(b),b},A=async b=>{const g=await N();await g.setRemoteDescription({type:"offer",sdp:b});const _=await g.createAnswer();return await g.setLocalDescription(_),new Promise(v=>{g.onicecandidate=q=>{!q.candidate&&g.localDescription!=null&&v(g.localDescription.sdp)}})},O=async b=>{const g=await N();g.onconnectionstatechange=()=>{g.connectionState==="connected"&&(t.info("connected to host"),b())}},ce=$t(n,y,b=>{const g=m.clone();R(g);for(const _ of g.getTracks())b.addTrack(_,g);Be(b,s,i,a,t,e)},t,o);return{createAnswer:A,setOnConnect:O,close:async()=>(await N()).close(),signalService:ce,createHostPeer:w,changeVolume:f,changeSpeakerVolume:d}},je=["\u53D7\u4FE1(\u524D\u534A)","\u53D7\u4FE1(\u5F8C\u534A)","\u9001\u4FE1(\u524D\u534A)","\u9001\u4FE1(\u5F8C\u534A)"],tn=kt("guestName","\u306A\u306A\u3057\u3055\u3093"),ee=me([]);var te="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-00-init.tsx";const nn=({setService:e,playAudio:t})=>{const n=S(),{color:o}=E(),s=x(_e),[i,a]=Ae(tn),l=x(ee),f=Ke();return r("div",{css:c({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}),children:r("div",{css:c({width:"100%",padding:"2rem"}),children:[r("div",{css:c({display:"flex",width:"100%",justifyContent:"center",marginBottom:"3rem"}),children:r("input",{type:"text",css:c({outline:"none",border:"none",fontSize:"1rem",padding:"0.25rem 0.5rem",height:"3rem",width:"14rem"}),onChange:m=>{a(m.target.value)},value:i},void 0,!1,{fileName:te,lineNumber:51,columnNumber:11},globalThis)},void 0,!1,{fileName:te,lineNumber:43,columnNumber:9},globalThis),r("div",{css:c({display:"flex",justifyContent:"center",alignItems:"center",width:"100%"}),children:r("button",{type:"button",css:c({padding:"0.5rem 1rem",outline:"none",border:"none",background:o.primary.main,color:o.primary.text,fontSize:"1.5rem",width:"14rem"}),onClick:async()=>{const m=await en(t,n,i,f);e(m),s(!0),l(d=>{d.push({stage:1})})},children:"\u63A5\u7D9A\u958B\u59CB"},void 0,!1,{fileName:te,lineNumber:68,columnNumber:11},globalThis)},void 0,!1,{fileName:te,lineNumber:67,columnNumber:9},globalThis)]},void 0,!0,{fileName:te,lineNumber:37,columnNumber:7},globalThis)},void 0,!1,{fileName:te,lineNumber:28,columnNumber:5},globalThis)};var ye="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-01-offer1.tsx";const on=()=>{const[e,t]=u.exports.useState(void 0),n=x(ee),o=S(),s=u.exports.useCallback(async a=>{o.info("offer1 received:"),t(a.binaryData)},[]),i=u.exports.useCallback(async()=>{e!=null&&n(a=>{a.push({stage:2,halfOffer:e})})},[e]);return r(C,{children:[r(X,{count:0,titles:je},void 0,!1,{fileName:ye,lineNumber:33,columnNumber:7},globalThis),r(j,{title:"1.\u30AA\u30D5\u30A1\u30FC\u53D7\u4FE1(\u524D\u534A)",children:[e==null&&r(Ne,{onResult:s},void 0,!1,{fileName:ye,lineNumber:35,columnNumber:29},globalThis),e&&r(Y,{nextTitle:"\u6B21\u3078",onNext:i},void 0,!1,{fileName:ye,lineNumber:36,columnNumber:21},globalThis)]},void 0,!0,{fileName:ye,lineNumber:34,columnNumber:7},globalThis)]},void 0,!0)};var xe="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-02-offer2.tsx";const sn=({stage:e,service:t})=>{const[n,o]=u.exports.useState(void 0),s=x(ee),i=S(),a=u.exports.useCallback(async f=>{i.info("offer2 received:");const m=ot(new Uint8Array([...e.halfOffer,...f.binaryData]));if(o(m),m!=null){o(m),await t.createHostPeer();const d=await t.createAnswer(m);s(p=>{p.push({stage:3,sdp:d})})}},[]),l=u.exports.useCallback(()=>{o(void 0),s(f=>{f.pop()})},[]);return r(C,{children:[r(X,{count:1,titles:je},void 0,!1,{fileName:xe,lineNumber:46,columnNumber:7},globalThis),r(j,{title:"2.\u30AA\u30D5\u30A1\u30FC\u53D7\u4FE1(\u5F8C\u534A)",children:[n==null&&r(Ne,{onResult:a},void 0,!1,{fileName:xe,lineNumber:48,columnNumber:27},globalThis),r(Y,{backTitle:"\u623B\u308B",onBack:l},void 0,!1,{fileName:xe,lineNumber:49,columnNumber:9},globalThis)]},void 0,!0,{fileName:xe,lineNumber:47,columnNumber:7},globalThis)]},void 0,!0)};var V="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-03-answer.tsx";const rn=({stage:e,service:t})=>{const n=x(ee),[o,s]=u.exports.useState(1),i=S(),a=o===1?"3.\u30A2\u30F3\u30B5\u30FC(\u524D\u534A)":"4.\u30A2\u30F3\u30B5\u30FC(\u5F8C\u534A)",l=at(e.sdp,o,i,[e],[e,o]),f=u.exports.useCallback(()=>{o===1&&s(2)},[]),m=u.exports.useCallback(()=>{if(o===2){s(1);return}n(d=>{d.pop(),d.pop()})},[]);return u.exports.useLayoutEffect(()=>{t.setOnConnect(()=>{n(d=>{d.push({stage:4})})})},[]),r(C,{children:[r(X,{count:1+o,titles:je},void 0,!1,{fileName:V,lineNumber:52,columnNumber:7},globalThis),r(j,{title:a,children:[l&&r("div",{css:c({display:"flex",justifyContent:"center",width:"100%",marginBottom:"1rem"}),children:r(rt,{src:l,cacheKey:`guest-answer-${o}`},void 0,!1,{fileName:V,lineNumber:56,columnNumber:13},globalThis)},void 0,!1,{fileName:V,lineNumber:55,columnNumber:11},globalThis),r("p",{css:c({width:"100%",fontFamily:"monospace",paddingLeft:"1rem"}),children:r("span",{children:`\u30DB\u30B9\u30C8\u306BQR\u30B3\u30FC\u30C9\u3092${o===2?"\u3082\u3046\u4E00\u5EA6":""}\u63D0\u793A\u3057\u3066\u304F\u3060\u3055\u3044\u3002`},void 0,!1,{fileName:V,lineNumber:60,columnNumber:11},globalThis)},void 0,!1,{fileName:V,lineNumber:59,columnNumber:9},globalThis),r(Y,{backTitle:"\u623B\u308B",nextTitle:o===1?"\u6B21\u3078":void 0,onNext:f,onBack:m},void 0,!1,{fileName:V,lineNumber:62,columnNumber:9},globalThis)]},void 0,!0,{fileName:V,lineNumber:53,columnNumber:7},globalThis)]},void 0,!0)};var mt="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-04-try-connect.tsx";const an=()=>{const e=x(ee);return u.exports.useEffect(()=>{e(()=>[{stage:5}])},[]),r(j,{title:"5. \u63A5\u7D9A\u4E2D",children:r("p",{children:"\u63A5\u7D9A\u4E2D\u3067\u3059..."},void 0,!1,{fileName:mt,lineNumber:16,columnNumber:7},globalThis)},void 0,!1,{fileName:mt,lineNumber:15,columnNumber:5},globalThis)};var Te="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-05-connection-list.tsx";const ln=({service:e})=>{const t=e.signalService.peers;return Ye(),r(j,{title:"\u63A5\u7D9A\u4E00\u89A7",children:r("ol",{children:[r("li",{children:"\u30DB\u30B9\u30C8"},void 0,!1,{fileName:Te,lineNumber:20,columnNumber:9},globalThis),Array.from(t.values()).map(n=>r("li",{children:`${n.id.slice(0,6)} ${n.name}`},n.id,!1,{fileName:Te,lineNumber:22,columnNumber:11},globalThis))]},void 0,!0,{fileName:Te,lineNumber:19,columnNumber:7},globalThis)},void 0,!1,{fileName:Te,lineNumber:18,columnNumber:5},globalThis)};var ae="D:\\komesu\\web\\qr-webrtc\\src\\components\\stages\\guest-stages.tsx";const cn=({service:e})=>{const t=P(ee),n=t[t.length-1];return n==null?null:n.stage===1?r(on,{},void 0,!1,{fileName:ae,lineNumber:25,columnNumber:12},globalThis):n.stage===2?r(sn,{stage:n,service:e},void 0,!1,{fileName:ae,lineNumber:28,columnNumber:12},globalThis):n.stage===3?r(rn,{stage:n,service:e},void 0,!1,{fileName:ae,lineNumber:31,columnNumber:12},globalThis):n.stage===4?r(an,{},void 0,!1,{fileName:ae,lineNumber:34,columnNumber:12},globalThis):n.stage===5?r(ln,{service:e},void 0,!1,{fileName:ae,lineNumber:37,columnNumber:12},globalThis):r(C,{},void 0,!1)};var le="D:\\komesu\\web\\qr-webrtc\\src\\components\\pages\\guest.tsx";const un=()=>{const e=u.exports.useRef(null),t=S(),[n,o]=u.exports.useState(void 0),s=u.exports.useCallback(async i=>{if(e.current==null){t.warn("ignore playAudio() since no audio element found.");return}e.current.srcObject=i,await e.current.play()},[]);return r("main",{css:c({width:"100%",height:"100%",maxWidth:1200}),children:[n==null&&r(nn,{setService:o,playAudio:s},void 0,!1,{fileName:le,lineNumber:31,columnNumber:27},globalThis),n&&r(cn,{service:n},void 0,!1,{fileName:le,lineNumber:32,columnNumber:19},globalThis),r(et,{audioRef:e},void 0,!1,{fileName:le,lineNumber:33,columnNumber:7},globalThis),n&&r(ut,{service:n},void 0,!1,{fileName:le,lineNumber:34,columnNumber:19},globalThis)]},void 0,!0,{fileName:le,lineNumber:24,columnNumber:5},globalThis)};var ke="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\mode-changer.tsx";const mn=()=>{const[e,t]=Ae(be),n=P(_e),o=S(),{color:s}=E(),i=e==="host"?"\u30DB\u30B9\u30C8":"\u30B2\u30B9\u30C8",a=e==="host"?"\u30B2\u30B9\u30C8":"\u30DB\u30B9\u30C8";return r("button",{className:oe({started:n}),css:c({width:"9rem",border:"none",outline:"none",padding:"0.125rem 0.5rem",background:`linear-gradient(135deg, ${s.primary.main} 50%, ${s.secondary.main} 50%)`,color:s.primary.text,"&.started":{background:s.background.dark,color:s.text}}),type:"button",onClick:()=>{if(n){o.warn("\u30BB\u30C3\u30B7\u30E7\u30F3\u304C\u958B\u59CB\u3055\u308C\u3066\u3044\u307E\u3059\u3002\u30E2\u30FC\u30C9\u3092\u5909\u66F4\u3067\u304D\u307E\u305B\u3093\u3002");return}t(l=>l==="host"?"guest":"host")},disabled:n,children:n?r("span",{children:i},void 0,!1,{fileName:ke,lineNumber:43,columnNumber:9},globalThis):r(C,{children:[r("span",{css:c({fontWeight:"bolder"}),children:`[${i}]`},void 0,!1,{fileName:ke,lineNumber:46,columnNumber:11},globalThis)," \u21D2 ",r("span",{children:a},void 0,!1,{fileName:ke,lineNumber:48,columnNumber:11},globalThis)]},void 0,!0)},void 0,!1,{fileName:ke,lineNumber:18,columnNumber:5},globalThis)};var $e="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\header.tsx";const dn=()=>{const{color:e}=E(),[t,n]=u.exports.useState("");return u.exports.useEffect(()=>{const o=Array.from(document.getElementsByTagName("script"));for(const s of o){const i=/index\.([^.]+)\.js$/.exec(s.src);if(i){n(i[1]);break}}},[]),r("header",{css:c({display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%",paddingLeft:"0.5rem",paddingRight:"1rem",background:e.background.light}),children:[r("span",{children:["QR WebRTC",t?` -${t}`:""]},void 0,!0,{fileName:$e,lineNumber:32,columnNumber:7},globalThis),r(mn,{},void 0,!1,{fileName:$e,lineNumber:33,columnNumber:7},globalThis)]},void 0,!0,{fileName:$e,lineNumber:21,columnNumber:5},globalThis)};var Pe="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\logs.tsx";const fn=fe.memo(function({item:t}){const{timestamp:n,level:o,message:s}=t,a=`${[n.getHours(),n.getMinutes(),n.getSeconds()].map(l=>l.toString(10).padStart(2,"0")).join(":")} [${o.toUpperCase()}] ${s}`;return r("li",{className:o,css:c({fontFamily:"monospace","&.info":{color:"#bdbdbd"},"&.warn":{color:"#ffa726"},"&.error":{color:"#ef5350"},"&.success":{color:"#29b6f6"}}),children:a},void 0,!1,{fileName:Pe,lineNumber:20,columnNumber:5},this)}),bn=fe.memo(function({items:t}){return r("ul",{css:c({height:"100%",paddingLeft:"0.5rem"}),children:t.map(n=>r(fn,{item:n},n.id,!1,{fileName:Pe,lineNumber:47,columnNumber:9},this))},void 0,!1,{fileName:Pe,lineNumber:45,columnNumber:5},this)});var I="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\volume-controller.tsx";const dt=({value:e,setValue:t,onMuteClick:n,icon:o,unlock:s})=>r("div",{css:c({display:"block"}),children:[r("input",{type:"range",step:s?.1:.01,min:0,max:s?8:1,value:e,onChange:i=>{t(i.currentTarget.value)}},void 0,!1,{fileName:I,lineNumber:18,columnNumber:7},globalThis),r("button",{css:c({outline:"none",border:"none",background:"transparent"}),type:"button",onClick:n,children:o},void 0,!1,{fileName:I,lineNumber:28,columnNumber:7},globalThis)]},void 0,!0,{fileName:I,lineNumber:17,columnNumber:5},globalThis),gn=()=>{const[e,t]=Ae(Fe);return r("div",{css:c({display:"flex",alignItems:"center",justifyContent:"space-around",width:"100%"}),children:[r("div",{css:c({display:"block"}),children:r(dt,{value:e.mic.volume,onMuteClick:()=>{t(n=>{n.mic.muted=!n.mic.muted})},setValue:n=>{t(o=>{o.mic.volume=Number(n)})},icon:e.mic.muted?"\u{1F515}":"\u{1F3A4}",unlock:!1},void 0,!1,{fileName:I,lineNumber:44,columnNumber:9},globalThis)},void 0,!1,{fileName:I,lineNumber:43,columnNumber:7},globalThis),r("div",{css:c({display:"block"}),children:r(dt,{value:e.speaker.volume,onMuteClick:()=>{t(n=>{n.speaker.muted=!n.speaker.muted})},setValue:n=>{t(o=>{o.speaker.volume=Number(n)})},icon:e.speaker.muted?"\u{1F507}":"\u{1F50A}",unlock:e.speaker.unlockLimit},void 0,!1,{fileName:I,lineNumber:61,columnNumber:9},globalThis)},void 0,!1,{fileName:I,lineNumber:60,columnNumber:7},globalThis)]},void 0,!0,{fileName:I,lineNumber:42,columnNumber:5},globalThis)};var L="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\navigations\\footer.tsx";const hn=()=>{const[e,t]=u.exports.useState(!1),{color:n}=E(),o=Bt(),s=o.length>0&&o[o.length-1].level==="error";return u.exports.useEffect(()=>{s&&t(!0)},[s]),r("footer",{className:oe({open:e}),css:c({display:"grid",height:"3.5rem",gridTemplateRows:"2rem 1.5rem 1fr",overflow:"hidden",transition:"all 0.5s","&.open":{height:"12rem"},background:n.background.dark,color:n.text}),children:[r("div",{css:c({display:"flex",alignItems:"center",borderBottom:`1px solid ${n.primary.dark}`,width:"100%"}),children:r(gn,{},void 0,!1,{fileName:L,lineNumber:44,columnNumber:9},globalThis)},void 0,!1,{fileName:L,lineNumber:36,columnNumber:7},globalThis),r("button",{type:"button",className:oe({error:s}),css:c({display:"flex",justifyContent:"right",alignItems:"center",width:"100%",height:"100%",paddingRight:"1rem",border:"none",outline:"none",background:n.background.dark,color:n.text,"&.error":{background:"#b61827"}}),onClick:()=>t(i=>!i),children:[r("span",{css:c({marginRight:"0.75rem"}),children:"\u30ED\u30B0"},void 0,!1,{fileName:L,lineNumber:69,columnNumber:9},globalThis),r("span",{className:oe({open:e}),css:c({display:"inline-block",height:"0.75rem",width:"0.75rem",borderLeft:"0.375rem solid transparent",borderBottom:"0.75rem solid white",borderRight:"0.375rem solid transparent",transition:"all 0.5s","&.open":{transform:"rotate(-180deg)"}})},void 0,!1,{fileName:L,lineNumber:70,columnNumber:9},globalThis)]},void 0,!0,{fileName:L,lineNumber:46,columnNumber:7},globalThis),r("div",{css:c({height:"100%",overflowY:"scroll",borderTop:`1px solid ${n.primary.dark}`,scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),children:r(bn,{items:o},void 0,!1,{fileName:L,lineNumber:97,columnNumber:9},globalThis)},void 0,!1,{fileName:L,lineNumber:86,columnNumber:7},globalThis)]},void 0,!0,{fileName:L,lineNumber:21,columnNumber:5},globalThis)};var G="D:\\komesu\\web\\qr-webrtc\\src\\components\\common\\layout.tsx";const pn=({children:e})=>{const{color:t}=E();return r(C,{children:[r("div",{css:c({display:"grid",width:"100%",height:"100%",gridTemplateRows:"2.5rem 1fr auto"}),children:[r("div",{css:c({height:"100%"}),children:r(dn,{},void 0,!1,{fileName:G,lineNumber:20,columnNumber:11},globalThis)},void 0,!1,{fileName:G,lineNumber:19,columnNumber:9},globalThis),r("div",{css:c({height:"100%",display:"flex",justifyContent:"center"}),children:e},void 0,!1,{fileName:G,lineNumber:22,columnNumber:9},globalThis),r("div",{css:c({height:"100%"}),children:r(hn,{},void 0,!1,{fileName:G,lineNumber:24,columnNumber:11},globalThis)},void 0,!1,{fileName:G,lineNumber:23,columnNumber:9},globalThis)]},void 0,!0,{fileName:G,lineNumber:18,columnNumber:7},globalThis),r(St,{styles:c({"html, body, #root":{height:"100%"},"*":{boxSizing:"border-box",margin:0,padding:0},"ul, ol":{margin:0,padding:0,listStyleType:"none"},body:{background:t.background.main,color:t.text,margin:0,padding:0}})},void 0,!1,{fileName:G,lineNumber:27,columnNumber:7},globalThis)]},void 0,!0)};var qe="D:\\komesu\\web\\qr-webrtc\\src\\components\\app.tsx";const Nn=()=>{const e=P(be),t=x(be);return u.exports.useLayoutEffect(()=>{st().catch(s=>{console.error(s)});const o=new URLSearchParams(window.location.hash.substring(1)).get("as")||"host";t(o==="host"?"host":"guest")},[]),U.exports.jsxDEV(pn,{children:e==="host"?U.exports.jsxDEV(Zt,{},void 0,!1,{fileName:qe,lineNumber:20,columnNumber:37},globalThis):U.exports.jsxDEV(un,{},void 0,!1,{fileName:qe,lineNumber:20,columnNumber:48},globalThis)},void 0,!1,{fileName:qe,lineNumber:20,columnNumber:10},globalThis)};var vn="D:\\komesu\\web\\qr-webrtc\\src\\components\\providers.tsx";const wn=({children:e})=>r(Ct,{children:e},void 0,!1,{fileName:vn,lineNumber:12,columnNumber:10},globalThis);function yn(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:s,onRegisterError:i}=e;let a,l;const f=async(m=!0)=>{m&&(a==null||a.addEventListener("controlling",d=>{d.isUpdate&&window.location.reload()})),l&&l.waiting&&await At(l.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){a=new Dt("/qr-webrtc-dev/sw.js",{scope:"/qr-webrtc-dev/"}),a.addEventListener("activated",m=>{m.isUpdate||o==null||o()});{const m=()=>{n==null||n()};a.addEventListener("waiting",m),a.addEventListener("externalwaiting",m)}a.register({immediate:t}).then(m=>{l=m,s==null||s(m)}).catch(m=>{i==null||i(m)})}return f}var Me="D:\\komesu\\web\\qr-webrtc\\src\\main.tsx";yn();_t.render(U.exports.jsxDEV(fe.StrictMode,{children:U.exports.jsxDEV(wn,{children:U.exports.jsxDEV(Nn,{},void 0,!1,{fileName:Me,lineNumber:12,columnNumber:7},globalThis)},void 0,!1,{fileName:Me,lineNumber:11,columnNumber:5},globalThis)},void 0,!1,{fileName:Me,lineNumber:10,columnNumber:3},globalThis),document.getElementById("root"));
